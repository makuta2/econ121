---
title: "ECON 121 FA23 Problem Set 1"
author: "Robert Tso"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) # sets the code chunk format
rm(list = ls()) # clears the environment
```

## Question 1

Verbal: list group members.
Robert Tso

\newpage

## Question 2

Code: Load packages and dataset, summarize the data.

Verbal: Interpret the summary statistics.

```{r message=FALSE, warning=FALSE}
# The PDF will show the code you write here but not the output.
# Load packages and dataset here.
library(readr)

install.packages("tidyverse")
library(tidyverse)
library(dplyr)

ssa_names <- read_csv("ssa_names.csv")
View(ssa_names)

```

```{r echo=TRUE}
# The PDF will show the code AND output here.
# Summarize the data here.
# List of newborn boys and girls starting from 1940 to 2022.

#girls
#filter by sex for female
girl_names <- ssa_names%>%
  filter(sex=="F") 
#create a new table and add up all frequency for the same names
summary_girls <- girl_names%>%
  group_by(name) %>%
  summarise(total_frequency = sum(frequency)) 
#filter by highest frequency
summary_girls%>%
  filter(total_frequency == max(total_frequency))

#boys
boy_names <- ssa_names%>%
  filter(sex=="M") 
#create a new table and add up all frequency for the same names
summary_boys <- boy_names%>%
  group_by(name) %>%
  summarise(total_frequency = sum(frequency)) 
#filter by highest frequency
summary_boys%>%
  filter(total_frequency == max(total_frequency))


```

\newpage

## Question 3

Code: Find the all time most common boy and girl names.

Verbal: Interpret your results.

```{r echo=TRUE}
#girls
#filter by sex for female
girl_names <- ssa_names%>%
  filter(sex=="F") 
#create a new table and add up all frequency for the same names
summary_girls <- girl_names%>%
  group_by(name) %>%
  summarise(total_frequency = sum(frequency)) 
#filter by highest frequency
summary_girls%>%
  filter(total_frequency == max(total_frequency))
#store total frequency for girls
most_common_girl <- max(summary_girls$total_frequency)


#boys
boy_names <- ssa_names%>%
  filter(sex=="M") 
#create a new table and add up all frequency for the same names
summary_boys <- boy_names%>%
  group_by(name) %>%
  summarise(total_frequency = sum(frequency)) 
#filter by highest frequency
summary_boys%>%
  filter(total_frequency == max(total_frequency))
#store total frequency for boys
most_common_boy <- max(summary_boys$total_frequency)

#add the total frequencies
print(most_common_girl+most_common_boy)
#Total of 6,261,170 babies of the 2 most popular names.

#Mary was the most popular name for girls at 1,997,025 and Michael for boys at 4,264,145 A total of 6,261,170 babies since 1940 were born under these 2 popular names.
```

\newpage

## Question 4

Code: Plot time trends in the number of unique names by sex

Verbal: Interpret your results.

```{r echo=TRUE}
# All question 4 code here

unique_girls_by_year <- girl_names %>%
  group_by(year) %>%
  summarise(unique_name_count = n_distinct(name))
unique_girls_by_year

unique_boys_by_year <- boy_names %>%
  group_by(year) %>%
  summarise(unique_name_count = n_distinct(name))
unique_boys_by_year

ggplot() +
  geom_line(data = unique_boys_by_year, aes(x = year, y = unique_name_count, color = "Boys")) +
  geom_line(data = unique_girls_by_year, aes(x = year, y = unique_name_count, color = "Girls")) +
  
  labs(x = "Year", y = "Number of Unique Names", title = "Unique Names by Year (Boys vs. Girls)") +
  scale_color_manual(values = c("Boys" = "blue", "Girls" = "pink")) +
  theme_minimal()

#Throughout the years, girls have had more unique names than boys, and they trend in similar ways. The number of unique names for both boys has remained relatively flat compared to girls until 1960-1970s. Both sexes peaked in uniqueness in 2008, where boys returned to a flat rate, while girls started declining.

```

\newpage

## Question 5

Code: Plot time trends in the number of unique names relative to the number of 
babies by sex.

Verbal: Interpret your results.

```{r echo=TRUE}
# All question 5 code here

```

\newpage

## Question 6

Verbal: Which names and why?

\newpage

## Question 7

Code: Find all-time frequency of your names and compare with all-time most
popular names.

Verbal: Interpret your results.

```{r echo=TRUE}
# All question 7 code here

```

\newpage

## Question 8

Code: Graph the annual frequencies of your chosen name(s) over time.

Verbal: Interpret your results.

```{r echo=TRUE}
# All question 8 code here

```

