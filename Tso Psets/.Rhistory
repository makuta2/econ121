logitmfx(health_dummy ~  incfam + age + education_category +
black + hisp + asian + other,
data = nhis2010,
atmean = TRUE,
robust = TRUE)
#marginal effect of IVs for poor and fair health using probit
probitmfx(health_dummy ~  incfam + age + education_category +
black + hisp + asian + other,
data = nhis2010,
atmean = TRUE,
robust = TRUE)
#marginal effect of IVs for mortality using logit
logitmfx(mort ~  incfam + age + education_category +
black + hisp + asian + other,
data = nhis2010,
atmean = TRUE,
robust = TRUE)
#marginal effect of IVs for poor and fair healt usin probit
probitmfx(mort ~ incfam + age + education_category +
black + hisp + asian + other,
data = nhis2010,
atmean = TRUE,
robust = TRUE)
#odds ratio of logit mortality
logitor(mort ~incfam+ age + education_category + black + hisp + asian + other,
data = nhis2010,
robust = TRUE)
#odds ratio of logit poor or fair health
logitor(health_dummy ~incfam+ age + education_category + black + hisp + asian + other,
data = nhis2010,
robust = TRUE)
# All question 6 code here
#looking at the percent of people in the survey that are of Group A or B
nhis2010 %>%
filter(asian*LessHS*Low==1) %>%
count()/count(nhis2010)
#0.375% are Group A
nhis2010 %>%
filter(black*ColGrad*High==1) %>%
count()/count(nhis2010)
#0.247% are Group B
logit_model_mort
deltaMethod(logit_model_mort,"(asian + LessHS + Low) - (black + ColGrad)",rhs=0)
#manually
#Group A is an asian adult with less than 12 years
#or education and family income less the 35k
GroupA <- (-0.580831612  #asian coef
+0.755474   #less than $35k
+0.362800)	 #less than 12 years edu
# Group B: Black adults with 16 years of education and family incomes over $100k
GroupB <- (-0.003324	 #black coef
+0.211033 # 16 years of edu
+0) #family income over 100k, 0 due to collinearity
GroupA-GroupB
# All question 8 code her
#model for smoking on mortality
logit_model_smoke <- feglm(mort ~  age + smokev +
Low + LowMed + Med + MedHigh + High +
LessHS + HsGrad + SomeCol + ColGrad + PostGrad +
black + hisp + asian + other,
data = nhis2010,
vcov = 'hetero',
family = 'logit')
#odds ratio of logit smoking
logitor(logit_model_smoke,
data = nhis2010,
robust = TRUE)
logit_model_smoke
#looking at the percent of people in the survey that smoke and are low income
nhis2010 %>%
filter(Low*smokeev==1) %>%
count()/count(nhis2010)
#looking at the percent of people in the survey that smoke and are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
#0.375% are Group A
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
#0.247% are Group B
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
#0.375% are Group A
#looking at the percent of people in the survey that smoke and are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
#0.375% are Group A
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
#0.247% are Group B
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#0.375% are Group A
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
#19.3% are low income and smoke
nhis2010 %>%
filter(Low==1|smokev==1) %>%
count()/count(nhis2010)
#22.5% are Low income, don't smoke
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
#22.5% are Low income, don't smoke
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#22.6% smoke, not Low income.
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
#19.3% are low income and smoke
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
#64.8% are Low income
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
#22.5% are Low income, don't smoke
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
#22.6% smoke, not Low income.
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#22.6% smoke, not Low income.
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
# Convert percentages to percentages (multiply by 100)
result_table <- result_table %>%
mutate(across(contains("percentage"), ~. * 100))
# Display the result table
print(result_table)
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Not_Low_income_percentage = (n()-sum(Low)) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
# Convert percentages to percentages (multiply by 100)
result_table <- result_table %>%
mutate(across(contains("percentage"), ~. * 100))
# Display the result table
print(result_table)
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
#41.9% smoke.
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
# Convert percentages to percentages (multiply by 100)
result_table <- result_table %>%
mutate(across(contains("percentage"), ~. * 100))
# Display the result table
print(result_table)
# All question 8 code her
#model for smoking on mortality
logit_model_smoke <- feglm(mort ~  age + smokev +
Low + LowMed + Med + MedHigh + High +
LessHS + HsGrad + SomeCol + ColGrad + PostGrad +
black + hisp + asian + other,
data = nhis2010,
vcov = 'hetero',
family = 'logit')
#odds ratio of logit smoking
logitor(logit_model_smoke,
data = nhis2010,
robust = TRUE)
logit_model_smoke
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
#19.3% are low income and smoke
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
#42.2% are Low income
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
#22.5% are Low income, don't smoke
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
#41.9% smoke.
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#22.6% smoke, not Low income.
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
# Convert percentages to percentages (multiply by 100)
result_table <- result_table %>%
mutate(across(contains("percentage"), ~. * 100))
# Display the result table
print(result_table)
# Calculate the percentages
nhis2010$Low <- prop.table(nhis2010[, c("LowIncome", "MediumIncome")], margin = 2)[, 1] * 100
# Calculate the percentages
nhis2010$Low <- prop.table(nhis2010[, c("Low", "Med")], margin = 2)[, 1] * 100
# Calculate the total percentages for smoking and non-smoking
total_percent_smoking <- sum(nhis2010$Low[data$smokev == 1], data$Med[data$Smoking == "Smoking"])
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
# Convert percentages to percentages (multiply by 100)
result_table <- result_table %>%
mutate(across(contains("percentage"), ~. * 100))
# Display the result table
print(result_table)
nhis2010 %>%
group_by(smokev)
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
) %>%
ungroup()
result_table
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n()
Total = n()
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n(),
Total = n()
) %>%
ungroup()
result_table
nhis <- nhis2010 %>%
drop_na((smokev))
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n(),
Total = n()
) %>%
ungroup()
result_table
# All question 8 code her
nhis2010 <- nhis2010 %>%
drop_na((smokev))
result_table <- nhis2010 %>%
group_by(smokev) %>%
summarize(
Low_income_percentage = sum(Low) / n(),
Medium_income_percentage = sum(Med) / n(),
Total = n()
) %>%
ungroup()
result_table
# Create a table of combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
# Create a table of combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
combination_table_percent <- (combination_table / n(nhis2010)) * 100
# Create a table of combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
combination_table_percent <- (combination_table / nrow(nhis2010)) * 100
# Print the combination table
print(combination_table)
# Create a table of combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)
total = nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
combination_table_percent <- (combination_table / total)) * 100
# Create a table of combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)
total = nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
combination_table_percent <- (combination_table / total) * 100
# Print the combination table
print(combination_table)
nrow(nhis2010)
combination_table <- table(nhis2010$Low, nhis2010$smokev)
combination_table
combination_table <- table(nhis2010$Low/n(nhis2010), nhis2010$smokev)/n(nhis2010)
combination_table <- table(nhis2010$Low/nrow(nhis2010), nhis2010$smokev)/nrow(nhis2010)
total = nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
combination_table_percent <- (combination_table) * 100
# Print the combination table
print(combination_table)
combination_table <- table(nhis2010$Low/nrow(nhis2010)*100,
nhis2010$smokev)/nrow(nhis2010)*100
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
combination_table <- table(nhis2010$Low/nrow(nhis2010),
nhis2010$smokev/nrow(nhis2010))
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
combination_table <- table(nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
print(combination_table_with_sums)
combination_table_with_sums <- addmargins(combination_table, FUN = list("Sum" = sum))
print(combination_table_with_sums)
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#19.4% are low income and smoke
#42.1% are Low income
#22.7% are Low income, don't smoke
#41.1% smoke.
#22.7% smoke, not Low income.
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010, nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010$Low, nhis2010$Med, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
# All question 8 code her
nhis2010 <- nhis2010 %>%
drop_na((smokev))
#model for smoking on mortality
logit_model_smoke <- feglm(mort ~  age + smokev +
Low + LowMed + Med + MedHigh + High +
LessHS + HsGrad + SomeCol + ColGrad + PostGrad +
black + hisp + asian + other,
data = nhis2010,
vcov = 'hetero',
family = 'logit')
#odds ratio of logit smoking
logitor(logit_model_smoke,
data = nhis2010,
robust = TRUE)
logit_model_smoke
#looking at the percent of people in the survey that smoke and/or are low income
nhis2010 %>%
filter(Low*smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
#19.4% are low income and smoke
#42.1% are Low income
#22.7% are Low income, don't smoke
#41.1% smoke.
#22.7% smoke, not Low income.
# Create a table of Low income and smoking combinations
combination_table <- table(nhis2010$Low, nhis2010$smokev)/nrow(nhis2010)
# Add row and column names for clarity
rownames(combination_table) <- c("LowIncome (No)", "LowIncome (Yes)")
colnames(combination_table) <- c("Smoking (No)", "Smoking (Yes)")
# Print the combination table
print(combination_table)
nhis2010 %>%
filter(Low==0,smokev==1) %>%
count()/count(nhis2010)
nhis2010 %>%
filter(Low==1,smokev==0) %>%
count()/count(nhis2010)
# Print the combination table
print(combination_table)
# All question 8 code her
nhis2010 <- nhis2010 %>%
drop_na((smokev))
#model for smoking on mortality
logit_model_smoke <- feglm(mort ~  age + smokev +
Low + LowMed + Med + MedHigh + High +
LessHS + HsGrad + SomeCol + ColGrad + PostGrad +
black + hisp + asian + other,
data = nhis2010,
vcov = 'hetero',
family = 'logit')
#odds ratio of logit smoking
logitor(logit_model_smoke,
data = nhis2010,
robust = TRUE)
logit_model_smoke
