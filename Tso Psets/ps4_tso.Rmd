---
title: "ECON 121 FA23 Problem Set 4"
author: "Robert Tso"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) # sets the code chunk format
rm(list = ls()) # clears the environment
```

## Question 1

Verbal: list group members.

Robert Tso - A13829791

Tomas Lopez - A16798775

Stephanie Nguyen - A16215540

Akash Juwadi - A16372772

\newpage

## Question 2

Code: Load packages and dataset, summarize data.

Verbal: Interpret the summary statistics.

Notable mean differences between the headstart participating children are sibdiff of 0.350750326, showing that children who are in headstart have a third likelihood to have siblings also in headstart. There are also 25% more black children but 4.7% less hispanic children. The largest impact is comp_score_5to6	with a mean difference of -5.560310055	and median difference of-6.0, showing that headstart children have lower test scores in this bracket. Logged income or lninc_0to3	with mean of -0.421336775	and median of -.5775361, showing that headstart children have 0.5	less logged income.


```{r message=FALSE, warning=FALSE}
# The PDF will show the code you write here but not the output.
# Load packages and dataset here.

rm(list=ls())
library(tidyverse)
library(fixest)

load(url("https://github.com/tvogl/econ121/raw/main/data/nlsy_kids.Rdata"))


```

```{r echo=TRUE}
# The PDF will show the code AND output here.
# Summarize the data here.



#looking at the amount of missing data to determine which ones are worth dropping.
colSums(is.na(nlsy_kids))/nrow(nlsy_kids)
#ppvt_3 is missing 80%+, dropping would result in most of the data being missing

nlsy_kids<-nlsy_kids %>% drop_na(lninc_0to3, momed, lnbw, 
                      comp_score_5to6 ,learndis)

view(nlsy_kids)

summary(nlsy_kids)


nlsy_kids_HS <- subset(nlsy_kids, head_start == 1)
nlsy_kids_NHS <- subset(nlsy_kids, head_start == 0)


#comparing the difference of mean and median of the two subsets of head_start

# Subset the dataset for head_start = 1
subset_head_start_1 <- subset(nlsy_kids, head_start == 1)

# Subset the dataset for head_start = 0
subset_head_start_0 <- subset(nlsy_kids, head_start == 0)

# Get the names of all variables in the dataset
all_variables <- names(nlsy_kids)

# Initialize vectors to store differences
mean_differences <- c()
median_differences <- c()

# Loop through variables
for (variable in all_variables) {
  # Skip non-numeric variables
  if (!is.numeric(nlsy_kids[[variable]])) {
    next
  }

  # Calculate mean and median for head_start = 1
  mean_head_start_1 <- mean(subset_head_start_1[[variable]])
  median_head_start_1 <- median(subset_head_start_1[[variable]])

  # Calculate mean and median for head_start = 0
  mean_head_start_0 <- mean(subset_head_start_0[[variable]])
  median_head_start_0 <- median(subset_head_start_0[[variable]])

  # Calculate differences
  mean_difference <- mean_head_start_1 - mean_head_start_0
  median_difference <- median_head_start_1 - median_head_start_0

  # Store differences in vectors
  mean_differences <- c(mean_differences, mean_difference)
  median_differences <- c(median_differences, median_difference)
}

# Create a data frame to display the results
results <- data.frame(
  Variable = all_variables,
  MeanDifference = mean_differences,
  MedianDifference = median_differences
)

# Print the results, head_start minus non_head_start
print(results)



```

\newpage

## Question 3

Code: Regression.

Verbal: Interpret.

Headstart has a -5.560 coefficient on test scores implying that by enrolling your child in a head start would result in a test score decrease by 5.6. With a t value of -4.888 the coefficient is statistically significant. It is reasonable to assume exogeneity, however it is likely there are omitted variables. We have to consider that the purpose of the headstart program is to help disadvantaged children with their education, so those enrolled in headstart may already have been on track to test lower scores down the line due to other environmental factors.


```{r echo=TRUE}
# All question 3 code here.

# Run OLS regression

ols_model <- lm(comp_score_5to6 ~ head_start, data = nlsy_kids)
summary(ols_model)

boxplot(comp_score_5to6 ~ head_start, data = nlsy_kids, main = "Comparison of Test Scores by Head Start Participation")


```

\newpage

## Question 4

Code: Regression.

Verbal: Interpret.

```{r echo=TRUE}
# All question 4 code here

```

\newpage

## Question 5

Code: Regression.

Verbal: Interpret.

```{r echo=TRUE}
# All question 5 code here

```

\newpage

## Question 6

Code: Regression.

Verbal: Interpret.

```{r echo=TRUE}
# All question 6 code here

```

\newpage

## Question 7

Code: Regressions.

Verbal: Interpret.

```{r echo=TRUE}
# All question 7 code here

```

\newpage

## Question 8

Code: Regressions.

Verbal: Interpret.

```{r echo=TRUE}
# All question 8 code here

```

\newpage

## Question 9

Code: Analysis of heterogeneity.

Verbal: Interpret.

```{r echo=TRUE}
# All question 9 code here

```

\newpage

## Question 9

Verbal: Policy implications.

